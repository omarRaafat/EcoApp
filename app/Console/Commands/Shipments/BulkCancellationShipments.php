<?php

namespace App\Console\Commands\Shipments;

use App\Integrations\Shipping\Integrations\Bezz\Bezz;
use App\Models\Transaction;
use Illuminate\Console\Command;

class BulkCancellationShipments extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'shipment:cancel-bulk 934032222638,461345602512,581461888509,824436532166,496298498389,428626421644,644473345885,442314345816,534911815261,708737612143,918131590495,705027567813,757535558294,170769554186,238339536090,188505522784,658378515887,600756501268,159657498415,892094498024,209023484587,763373467992,672746454039,118001451937,898609448997,322744440863,416401439246,959389428545,464064389961,207860386975,466276374215,258212312074,611207310700,812154305469,163082262568,156472220455,987152220179,429270210600,470324202938,747438197818,945464129828,831494127293,376907070871,427513049780,823527032217,974570938035,721146924397,618600887400,278234869267,345820869134,571730866654,331150857580,922626854314,651955847217,939443776164,361716776001,361258775520,954067775140,180572768330,208213728562,230714691739,822514643372,750068639281,128817626737,423109609304,543597608140,816468607145,154864587688,689138516678,964507507659,646440452299,238255448069,656242374108,591474323344,863337290399,814976269525,634327212084,828985123449,979431088039,917780084131,453619083217,135141080371,952513069464,522602062686,930130041343,746249040162,679895000742,326833917176,803673823538,545090821582,467074820855,450740799505,765770782104,237967748433,555246744555,453219742248,463430727588,325007677477,832554663030,129896653782,946641642286,404383401399,900203324420{orders_no}';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Cancel shipment based on order number';

    /**
     * Execute the console command.
     *
     * @return int
     */
    public function handle()
    {
        $orders = explode(',', $this->argument('orders_no'));

        $this->withProgressBar($orders, function ($order_number) {
            try {
                (new Bezz)->cancelShipment(Transaction::firstWhere('code', $order_number));
            } catch (\Exception $exception){}
        });

    }
}